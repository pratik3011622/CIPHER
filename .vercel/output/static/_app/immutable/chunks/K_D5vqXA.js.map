{"version":3,"file":"K_D5vqXA.js","sources":["../../../../../../node_modules/sveltefire/dist/stores/firestore.js","../../../../../../node_modules/sveltefire/dist/components/Doc.svelte"],"sourcesContent":["import { writable } from \"svelte/store\";\nimport { doc, collection, onSnapshot } from \"firebase/firestore\";\n/**\n * @param  {Firestore} firestore firebase firestore instance\n * @param  {string|DocumentReference} ref document path or reference\n * @param  {T} startWith optional default data\n * @returns a store with realtime updates on document data\n */\nexport function docStore(firestore, ref, startWith) {\n    let unsubscribe;\n    // Fallback for SSR\n    if (!globalThis.window) {\n        const { subscribe } = writable(startWith);\n        return {\n            subscribe,\n            ref: null,\n            id: \"\",\n        };\n    }\n    // Fallback for missing SDK\n    if (!firestore) {\n        console.warn(\"Firestore is not initialized. Are you missing FirebaseApp as a parent component?\");\n        const { subscribe } = writable(null);\n        return {\n            subscribe,\n            ref: null,\n            id: \"\",\n        };\n    }\n    const docRef = typeof ref === \"string\"\n        ? doc(firestore, ref)\n        : ref;\n    const { subscribe } = writable(startWith, (set) => {\n        unsubscribe = onSnapshot(docRef, (snapshot) => {\n            set(snapshot.data() ?? null);\n        });\n        return () => unsubscribe();\n    });\n    return {\n        subscribe,\n        ref: docRef,\n        id: docRef.id,\n    };\n}\n/**\n * @param  {Firestore} firestore firebase firestore instance\n * @param  {string|Query|CollectionReference} ref collection path, reference, or query\n * @param  {[]} startWith optional default data\n * @returns a store with realtime updates on collection data\n */\nexport function collectionStore(firestore, ref, startWith = []) {\n    let unsubscribe;\n    // Fallback for SSR\n    if (!globalThis.window) {\n        const { subscribe } = writable(startWith);\n        return {\n            subscribe,\n            ref: null,\n        };\n    }\n    // Fallback for missing SDK\n    if (!firestore) {\n        console.warn(\"Firestore is not initialized. Are you missing FirebaseApp as a parent component?\");\n        const { subscribe } = writable([]);\n        return {\n            subscribe,\n            ref: null,\n        };\n    }\n    const colRef = typeof ref === \"string\" ? collection(firestore, ref) : ref;\n    const { subscribe } = writable(startWith, (set) => {\n        unsubscribe = onSnapshot(colRef, (snapshot) => {\n            const data = snapshot.docs.map((s) => {\n                return { id: s.id, ref: s.ref, ...s.data() };\n            });\n            set(data);\n        });\n        return () => unsubscribe();\n    });\n    return {\n        subscribe,\n        ref: colRef,\n    };\n}\n","<script generics=\"Data extends DocumentData\">import { docStore } from \"../stores/firestore.js\";\nimport { getFirebaseContext } from \"../stores/sdk.js\";\nexport let ref;\nexport let startWith = void 0;\nconst { firestore } = getFirebaseContext();\nlet store = docStore(firestore, ref, startWith);\n</script>\n\n{#if $store !== undefined && $store !== null}\n  <slot data={$store} ref={store.ref} {firestore} />\n{:else}\n  <slot name=\"loading\" />\n{/if}\n"],"names":["docStore","firestore","ref","startWith","unsubscribe","subscribe","writable","docRef","doc","set","onSnapshot","snapshot","ctx","$$props","getFirebaseContext","store"],"mappings":"2kBAQO,SAASA,EAASC,EAAWC,EAAKC,EAAW,CAChD,IAAIC,EAEJ,GAAI,CAAC,WAAW,OAAQ,CACpB,KAAM,CAAE,UAAAC,CAAS,EAAKC,EAASH,CAAS,EACxC,MAAO,CACH,UAAAE,EACA,IAAK,KACL,GAAI,EAChB,CACI,CAEA,GAAI,CAACJ,EAAW,CACZ,QAAQ,KAAK,kFAAkF,EAC/F,KAAM,CAAE,UAAAI,CAAS,EAAKC,EAAS,IAAI,EACnC,MAAO,CACH,UAAAD,EACA,IAAK,KACL,GAAI,EAChB,CACI,CACA,MAAME,EAAS,OAAOL,GAAQ,SACxBM,EAAIP,EAAWC,CAAG,EAClBA,EACA,CAAE,UAAAG,CAAS,EAAKC,EAASH,EAAYM,IACvCL,EAAcM,EAAWH,EAASI,GAAa,CAC3CF,EAAIE,EAAS,KAAI,GAAM,IAAI,CAC/B,CAAC,EACM,IAAMP,EAAW,EAC3B,EACD,MAAO,CACH,UAAAC,EACA,IAAKE,EACL,GAAIA,EAAO,EACnB,CACA,yDClCcK,EAAM,CAAA,EAAO,IAAAA,KAAM,4jBAD5B,OAAAA,EAAM,CAAA,IAAK,QAAaA,OAAW,KAAI,+WANjC,IAAAV,CAAG,EAAAW,EACH,CAAA,UAAAV,QAAkB,EAAAU,EACrB,KAAA,CAAA,UAAAZ,CAAS,EAAKa,EAAkB,EACpC,IAAAC,EAAQf,EAASC,EAAWC,EAAKC,CAAS","x_google_ignoreList":[0,1]}